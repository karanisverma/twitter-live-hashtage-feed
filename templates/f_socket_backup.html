<!DOCTYPE HTML>
<html>

<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.2/jquery.min.js"></script>
    <script type="text/javascript">
    function WebSocketTest() {
        if ("WebSocket" in window) {
            // alert("WebSocket is supported by your Browser!");

            // Let us open a web socket
            var ws = new WebSocket("ws://127.0.0.1:5000/t");

            // ws.onopen = function()
            // {
            //    // Web Socket is connected, send data using send()
            //    ws.send("Message to send");
            //    alert("Message is sent...");
            // };

            ws.onmessage = function(evt) {
                var received_msg = JSON.parse(evt.data);
                console.log(received_msg.text);
                // alert("loloMessage is received...");
            };

            ws.onclose = function() {
                // websocket is closed.
                alert("Connection is closed...");
            };
        } else {
            // The browser doesn't support WebSocket
            alert("WebSocket NOT supported by your Browser!");
        }
    }



    </script>
</head>


<body>
    <div id="sse">
    <input type="text" name="query" class ="q">
    <button class = "search" onclick="WebSocketTest()">Search</button>
        <!-- <a href="javascript:WebSocketTest()">Run WebSocket</a> -->
    </div>
</body>
<script type="text/javascript">
       $(".search").click(function() {
      var q = $(".q").val();
      console.log("value of q is => " +q);
       $.ajax({
            url: '/search',
            method: "POST",
            dataType: 'json',
            contentType: 'application/json;charset=UTF-8',
            data: JSON.stringify({ query:q}),
            success: function (data) {
                alert("YAY Sucessful");

            }
        });
    });
</script>
</html>
